//for Location

let

    //To unlink query from Repo simply insert comment the repo lines below and uncomment line above (replacing SQL with query). 
    repoSource = Repo_Files,
    extract_Name = "Location.txt",
    #"Repo Site File" = Table.SelectRows(repoSource, each Text.Contains([Path], extract_Name) and Text.Contains([Path], "/"&RepoSiteFolder&"/") ),
    #"Repo Global File" = Table.SelectRows(repoSource, each Text.Contains([Path], extract_Name) and Text.Contains([Path], "/Global/") ),
    #"ChooseFile" = if #"Repo Site File" is null then #"Repo Global File" else #"Repo Site File",

    SQL = Text.Combine(Lines.FromBinary(Web.Contents(#"ChooseFile"{0}[RawPath]), null, null, 65001), "#(lf)"),
    Param1 = Text.Replace(SQL, "&[ReportingStartDate]&", ReportingStartDate),
    Param2 = Text.Replace(Param1, "&[ReportingEndDate]&", "2020/02/02"),
    Param3 = Text.Replace(Param2, "&[TestPatientList]&", Text.Combine(List.Transform(Test_PatientList[Pat_ID1], Text.From), ",")),
    Query = Param3,
    // Add more Text.Replace lines for each parameter reference in your SQL query



    Source = Sql.Database(SourceServerName, SourceDatabaseName, [Query=Query])
in
    Source